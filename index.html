<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Pcapng decoder JAVA library by akinaru</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Pcapng decoder JAVA library</h1>
      <h2 class="project-tagline">Pcapng decoder JAVA library</h2>
      <a href="https://github.com/akinaru/pcapng-decoder" class="btn">View on GitHub</a>
      <a href="https://github.com/akinaru/pcapng-decoder/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/akinaru/pcapng-decoder/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="pcapng-decoder-library" class="anchor" href="#pcapng-decoder-library" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>PCAPNG Decoder Library</h1>

<p><a href="http://akinaru.github.io/pcapng-decoder/">http://akinaru.github.io/pcapng-decoder/</a></p>

<p><a href="https://travis-ci.org/akinaru/pcapng-decoder"><img src="https://travis-ci.org/akinaru/pcapng-decoder.svg?branch=master" alt="Build Status"></a>
<a href="https://bintray.com/akinaru/maven/pcapng-parser/_latestVersion"> <img src="https://api.bintray.com/packages/akinaru/maven/pcapng-parser/images/download.svg" alt="Download"> </a>
<a href="https://www.codacy.com/app/kiruazoldik92/pcapng-decoder?utm_source=github.com&amp;amp;utm_medium=referral&amp;amp;utm_content=akinaru/pcapng-decoder&amp;amp;utm_campaign=Badge_Grade"><img src="https://api.codacy.com/project/badge/Grade/1188df87489749a48978a5d953662d18" alt="Codacy Badge"></a>
<a href="http://javadoc-badge.appspot.com/com.github.akinaru/pcapngdecoder"><img src="http://javadoc-badge.appspot.com/com.github.akinaru/pcapngdecoder.svg?label=javadoc" alt="Javadoc"></a>
<a href="LICENSE.md"><img src="http://img.shields.io/:license-mit-blue.svg" alt="License"></a></p>

<p>Java PCAPNG file parser library</p>

<p><a href="CHANGELOG.md">show changelog</a></p>

<h2>
<a id="include-in-your-project" class="anchor" href="#include-in-your-project" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Include in your project</h2>

<ul>
<li>from gradle </li>
</ul>

<pre><code>compile 'com.github.akinaru:pcapngdecoder:1.2'
</code></pre>

<ul>
<li>from release archive</li>
</ul>

<p><a href="https://github.com/akinaru/pcapng-decoder/releases">https://github.com/akinaru/pcapng-decoder/releases</a></p>

<h2>
<a id="run-example" class="anchor" href="#run-example" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Run example</h2>

<pre><code>./gradlew run -PappArgs="['-f', 'path_to_file/pcapfile/exemple.pcapng'  , '-v' ]"
</code></pre>

<table>
<thead>
<tr>
<th>args</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-f </td>
<td>input file</td>
</tr>
<tr>
<td>-v</td>
<td>verbose, will show all section parsing content</td>
</tr>
</tbody>
</table>

<p>Example source code can be found <a href="https://github.com/akinaru/pcapng-decoder/tree/master/examples">here</a></p>

<h2>
<a id="how-to-use-" class="anchor" href="#how-to-use-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>How to use ?</h2>

<h3>
<a id="decode" class="anchor" href="#decode" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Decode</h3>

<ul>
<li>decode from n input file :</li>
</ul>

<pre><code>PcapDecoder decoder = new PcapDecoder("path/to/file.pcapng");
decoder.decode();
</code></pre>

<ul>
<li>decode from a byte array :</li>
</ul>

<pre><code>byte[] pcapBa = getPcapBa();
PcapDecoder decoder = new PcapDecoder(pcapBa);
decoder.decode();
</code></pre>

<h3>
<a id="data-access" class="anchor" href="#data-access" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Data access</h3>

<p>Pcap section list can be accessed via <code>getSectionList()</code> :</p>

<pre><code>ArrayList&lt;IPcapngType&gt; sectionList = decoder.getSectionList()
</code></pre>

<p>All section type inherit from <code>IPcapngType</code>, use reflection to access each type :</p>

<pre><code>for (int i = 0; i &lt; sectionList.size(); i++) {

    if (sectionList.get(i) instanceof ISectionHeaderBlock) {

        ISectionHeaderBlock section = (ISectionHeaderBlock) sectionList.get(i);

        //do what you want with Section Header Block frame type

    } else if (sectionList.get(i) instanceof IDescriptionBlock) {

        IDescriptionBlock section = (IDescriptionBlock) sectionList.get(i);

        //do what you want with Description Block frame type 

    } else if (sectionList.get(i) instanceof IEnhancedPacketBLock) {

        IEnhancedPacketBLock section = (IEnhancedPacketBLock) sectionList.get(i);

        //do what you want with Enhanced Packet Block frame type 

    } else if (sectionList.get(i) instanceof IStatisticsBlock) {

        IStatisticsBlock section = (IStatisticsBlock) sectionList.get(i);

        //do what you want with Statistics Block frame type 

    } else if (sectionList.get(i) instanceof INameResolutionBlock) {

        INameResolutionBlock section = (INameResolutionBlock) sectionList.get(i);

        //do what you want with Name Resolution Block frame type
    }
}
</code></pre>

<p><b>Note</b> : packet data in Enhanced Packet Block is left in packet source endianness</p>

<h2>
<a id="javadoc" class="anchor" href="#javadoc" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>JavaDoc</h2>

<p><a href="http://javadoc-badge.appspot.com/com.github.akinaru/pcapngdecoder">http://javadoc-badge.appspot.com/com.github.akinaru/pcapngdecoder</a></p>

<h2>
<a id="example-output" class="anchor" href="#example-output" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Example output</h2>

<pre><code>##########################################################
SECTION HEADER BLOCK
Major version      : 0
Minor version      : 1
OS                 : Linux 3.8.0-19-generic
user application   : Dumpcap 1.10.2 (SVN Rev 51934 from /trunk-1.10)
##########################################################
SECTION INTERFACE DESCRIPTION BLOCK
Link type             : LINKTYPE_IEEE802_11_RADIO
Snap len              : 65535
interface name        : wlan0
timestamp resolution  : 6
interface OS name     : Linux 3.8.0-19-generic
##########################################################
SECTION ENHANCED PACKET BLOCK
interface id             : 0
timestamp in millis      : Sat Apr 18 12:13:41 CEST 2015
captured length          : 185
packet length            : 185
packet data              : 00 | 00 | 12 | 00 | 2E | 48 | 00 | 00 | 10 | 02 | A3 | 09 | A0 | 00 | C2 | 07 | 00 | 00 | 80 | 00 | 00 | 00 | FF | FF | FF | FF | FF | FF | 00 | 24 | D4 | 6B | 0C | 5D | 00 | 24 | D4 | 6B | 0C | 5D | 00 | E5 | 60 | 01 | 25 | DE | 32 | 03 | 00 | 00 | 60 | 00 | 01 | 04 | 00 | 08 | 46 | 72 | 65 | 65 | 57 | 69 | 66 | 69 | 01 | 08 | 82 | 84 | 8B | 96 | 2C | 0C | 12 | 18 | 03 | 01 | 0C | 05 | 04 | 00 | 02 | 00 | 00 | 2A | 01 | 04 | 32 | 05 | 24 | 30 | 48 | 60 | 6C | 2D | 1A | 6C | 00 | 03 | FF | FF | FF | 00 | 01 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 01 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 3D | 16 | 0C | 00 | 13 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 7F | 08 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 40 | DD | 18 | 00 | 50 | F2 | 02 | 01 | 01 | 00 | 00 | 03 | A4 | 00 | 00 | 27 | A4 | 00 | 00 | 42 | 43 | 5E | 00 | 62 | 32 | 2F | 00 | A3 | 26 | 13 | 07
##########################################################
SECTION INTERFACE STATISTICS BLOCK
interface id             : 0
timestamp in millis      : Sat Apr 18 12:16:43 CEST 2015
capture start time       : Sat Apr 18 12:13:41 CEST 2015
capture end time         : Sat Apr 18 12:16:43 CEST 2015
packet received count    : 9493
packet drop count        : 0
##########################################################
</code></pre>

<h2>
<a id="compatibility" class="anchor" href="#compatibility" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Compatibility</h2>

<p>JRE 1.7 compliant</p>

<h2>
<a id="build" class="anchor" href="#build" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Build</h2>

<p>Gradle using IntelliJ IDEA or Eclipse</p>

<h2>
<a id="specifications" class="anchor" href="#specifications" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Specifications</h2>

<p><a href="https://www.winpcap.org/ntar/draft/PCAP-DumpFileFormat.html">https://www.winpcap.org/ntar/draft/PCAP-DumpFileFormat.html</a></p>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>License</h2>

<p>The MIT License (MIT) Copyright (c) 2015-2016 Bertrand Martel</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/akinaru/pcapng-decoder">Pcapng decoder JAVA library</a> is maintained by <a href="https://github.com/akinaru">akinaru</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-62569105-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
